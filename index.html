# build_artifact5.py
# ------------------------------------------------------------
# Creates a complete Artifact 5 for your portfolio:
# - Generates 4 charts/diagrams with matplotlib
# - Writes a styled HTML page that embeds the images + artifact text
# - Writes a short reflection (Markdown) for submission
# Output folder: artifact5_leadership_framework/
# ------------------------------------------------------------

import os
from pathlib import Path
import textwrap
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import FancyArrowPatch, Rectangle

# ---------- Setup ----------
OUT_DIR = Path("artifact5_leadership_framework")
IMG_DIR = OUT_DIR
OUT_DIR.mkdir(parents=True, exist_ok=True)

# ---------- Helper: write file ----------
def write(path: Path, content: str):
    path.write_text(content.strip() + "\n", encoding="utf-8")

# ---------- Figure 1: Radar (Leadership Competencies) ----------
def make_radar(path: Path):
    labels = ["Ethical Governance","Change Leadership","Communication","Technical Fluency","Collaboration","Learning Agility"]
    scores = np.array([4.5, 4.2, 4.6, 3.9, 4.7, 4.8])  # 1–5 example
    angles = np.linspace(0, 2*np.pi, len(labels), endpoint=False).tolist()
    scores_closed = np.concatenate((scores, [scores[0]]))
    angles_closed = angles + [angles[0]]

    fig = plt.figure(figsize=(6,6))
    ax = plt.subplot(111, polar=True)
    ax.plot(angles_closed, scores_closed, linewidth=2)
    ax.fill(angles_closed, scores_closed, alpha=0.2)
    ax.set_thetagrids(np.degrees(angles), labels)
    ax.set_ylim(0,5)
    ax.set_title("Leadership Competency Profile (Self-Assessment)")
    fig.tight_layout()
    fig.savefig(path, dpi=160, bbox_inches="tight")
    plt.close(fig)

# ---------- Figure 2: Roadmap (Gantt-style) ----------
def make_gantt(path: Path):
    tasks = [
        ("Ethical AI Checklist + Model Card", 0, 3),
        ("Brown-bag Sessions (Staff Training)", 1, 4),
        ("Pilot Projects Using Framework", 3, 6),
        ("Integrate Governance into SDLC", 6, 6),
        ("Mentorship & Community of Practice", 9, 6),
        ("Establish Review Board", 10, 8),
    ]
    fig, ax = plt.subplots(figsize=(8,4.5))
    for i,(name,start,duration) in enumerate(tasks):
        ax.barh(i, duration, left=start, height=0.5)
        ax.text(start+duration+0.2, i, name, va='center')
    ax.set_yticks([])
    ax.set_xlabel("Months from Start")
    ax.set_title("Leadership Framework Roadmap (12–18 Months)")
    ax.set_xlim(0,18)
    fig.tight_layout()
    fig.savefig(path, dpi=160, bbox_inches="tight")
    plt.close(fig)

# ---------- Figure 3: Governance Lifecycle ----------
def make_lifecycle(path: Path):
    fig, ax = plt.subplots(figsize=(10,3))
    ax.set_xlim(0, 10); ax.set_ylim(0, 3); ax.axis('off')
    stages = ["Problem Framing","Data & Governance","Modeling & Validation","Deployment","Monitoring & Drift","Review & Iterate"]
    x_positions = [0.2, 1.9, 3.8, 5.7, 7.6, 9.1]
    width, height = 1.4, 1.2
    for x,stage in zip(x_positions, stages):
        rect = Rectangle((x,1), width, height, fill=True, alpha=0.15, ec='black')
        ax.add_patch(rect)
        ax.text(x+width/2, 1+height/2, stage, ha='center', va='center', fontsize=9, wrap=True)
    for i in range(len(x_positions)-1):
        ax.add_patch(FancyArrowPatch((x_positions[i]+width, 1.6), (x_positions[i+1], 1.6), arrowstyle='->', mutation_scale=12))
    ax.set_title("AI/ML Governance Lifecycle")
    fig.tight_layout()
    fig.savefig(path, dpi=160, bbox_inches="tight")
    plt.close(fig)

# ---------- Figure 4: RACI Matrix ----------
def make_raci(path: Path):
    activities = ["Problem Framing","Data Governance","Model Training","Validation & Fairness","Deployment","Monitoring & Drift","Incident Response"]
    roles = ["Product","Data Science","MLOps","Compliance/Risk","Exec Sponsor"]
    # 1=R, 2=A, 3=C, 4=I (we color by value only for visualization)
    mapping = [
        [2,1,3,4,4],
        [4,3,3,2,4],
        [4,2,3,4,4],
        [4,2,3,2,4],
        [4,3,2,4,4],
        [4,3,2,3,4],
        [4,3,2,2,4],
    ]
    M = np.array(mapping)

    fig, ax = plt.subplots(figsize=(8,4.8))
    im = ax.imshow(M, aspect='auto')
    ax.set_xticks(np.arange(len(roles))); ax.set_xticklabels(roles, rotation=20, ha='right')
    ax.set_yticks(np.arange(len(activities))); ax.set_yticklabels(activities)
    ax.set_title("RACI Matrix (R=Responsible, A=Accountable, C=Consulted, I=Informed)")
    for i in range(M.shape[0]):
        for j in range(M.shape[1]):
            val = M[i,j]
            letter = {1:"R",2:"A",3:"C",4:"I"}[val]
            ax.text(j, i, letter, ha='center', va='center', color='white' if val<3 else 'black')
    fig.colorbar(im, ax=ax, fraction=0.046, pad=0.04)
    fig.tight_layout()
    fig.savefig(path, dpi=160, bbox_inches="tight")
    plt.close(fig)

# ---------- Artifact Text Blocks ----------
TITLE = "Personal AI/ML Leadership Framework: Ethical, Practical, and People-Centered Change"

EXEC_SUMMARY = """
This framework summarizes how I lead AI/ML work with clarity, ethics, and measurable results. It integrates a mission statement, core values,
concrete objectives, and action plans. The goals are to deliver trustworthy AI outcomes, communicate clearly with stakeholders, and build a culture
of iterative learning and responsible innovation.
"""

TECH_OVERVIEW = """
The framework operationalizes AI leadership across the model lifecycle: problem framing, data governance, model evaluation/monitoring,
risk controls, and change enablement. It specifies role clarity (product, data, MLOps, compliance), decision checkpoints (model cards,
PR-AUC/recall thresholds, risk reviews), and continuous improvement (post-deployment drift checks, 360 feedback, retrospectives).
"""

CONTEXT = """
AI success often fails not for technical reasons, but due to unclear goals, weak governance, and limited stakeholder alignment.
This framework addresses that gap by defining a repeatable approach to leading AI/ML initiatives that are useful, usable, and ethical.
"""

APPROACH = """
1) Mission: Deliver AI that solves real problems while honoring transparency, fairness, and stewardship.
2) Core Values: Integrity, responsibility, collaboration, lifelong learning, and service.
3) Objectives (SMART):
   • Establish an ethical AI checklist and model card template across projects (quarterly adoption ≥ 80%).
   • Improve stakeholder comprehension via executive briefs for every project (+30% comprehension by survey).
   • Build a feedback loop for deployed models (drift alerts, recalibration cadence monthly/quarterly).
4) Action Plans:
   • Short-term (0–6 mo): finalize templates (model cards, risk checklist), run brown-bag sessions, enable metric visibility dashboards.
   • Mid-term  (6–12 mo): run 2–3 cross-functional pilots using the framework; integrate approvals into SDLC.
   • Long-term (12+ mo): formalize governance (review boards), mentorship pipeline, and continuous training.
"""

AUDIENCES = """
• Executives / Non-Technical: business impact, risk posture, expected ROI, timeline, change plan.
• Technical Leads / Data Scientists: data quality rules, metrics (PR-AUC, recall@threshold), monitoring and drift actions, rollout guardrails.
• Risk/Compliance: documentation standards, fairness checks, human-in-the-loop controls, incident response.
"""

COMPETENCIES = """
• Change leadership and stakeholder alignment
• Ethical AI governance and documentation (model cards, risk checklists)
• Communication across technical and non-technical audiences
• Continuous improvement (metrics, feedback loops, retrospectives)
"""

OUTCOMES = """
• Standardized model card and ethical checklist now used across artifacts.
• Clear executive brief format added to each project page.
• Portfolio now includes Metrics & Evaluation sections and GitHub code links for transparency.
"""

METRICS = """
• Adoption of governance artifacts (≥ 80% of projects)
• Post-read stakeholder comprehension score (+30% from baseline)
• Model monitoring in place (drift detection + action log)
• Lead time to insight reduced through clearer scoping and iteration
"""

CHANGES_FROM_FEEDBACK = """
1) Clarity & Business Impact — Each artifact ends with a “Business Impact / So What?” paragraph.
2) Metrics & Evaluation — Standard metrics blocks per artifact (e.g., F1, R², Silhouette, RMSE).
3) Code Transparency — GitHub repository links included for each artifact.
4) Skills “Toolbox” — A top-level Technical Skills panel for quick scanning by recruiters.
5) Cohesive Styling — Standardized headings, figure captions, and CTAs across artifacts.
"""

COMPLETION = """
The first four artifacts demonstrate technical breadth (predictive analytics, NLP, forecasting, clustering).
This fifth artifact proves I can lead AI work—aligning teams, ensuring ethics, communicating across audiences,
and driving sustainable outcomes. Together, the five artifacts represent my best work in AI/ML.
"""

REFLECTION_MD = """
# Reflection — Portfolio Artifact 5

I selected my Personal AI/ML Leadership Framework as the fifth artifact because it complements my technical projects with a clear,
repeatable approach to leading AI responsibly. It captures my growth as a leader who can align stakeholders, communicate across audiences,
and ensure models are governed, monitored, and continuously improved.

From Workshop Five feedback, I implemented portfolio-wide upgrades: (1) explicit business impact statements, (2) Metrics & Evaluation
sections so success is quantifiable, and (3) GitHub links for transparency. I also added a Technical Skills / Toolbox near my bio for quick
scanning by recruiters. These changes made my portfolio more cohesive, professional, and audience-aware. The final version demonstrates
both AI/ML competencies and the leadership capacity to deploy them ethically and effectively.
"""

# ---------- Build images ----------
radar_path = IMG_DIR / "artifact5_radar_competencies.png"
gantt_path = IMG_DIR / "artifact5_roadmap_gantt.png"
lifecycle_path = IMG_DIR / "artifact5_governance_lifecycle.png"
raci_path = IMG_DIR / "artifact5_raci_matrix.png"

make_radar(radar_path)
make_gantt(gantt_path)
make_lifecycle(lifecycle_path)
make_raci(raci_path)

# ---------- Build HTML ----------
HTML = f"""
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Artifact 5 — Personal AI/ML Leadership Framework</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {{ font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin:0; color:#1b1f23; background:#f6f8fa; }}
  .wrap {{ max-width: 980px; margin: 0 auto; padding: 24px; }}
  header {{ background: white; border:1px solid #e1e4e8; border-radius:12px; padding:20px; }}
  h1 {{ margin:0 0 6px; }}
  .muted {{ color:#586069; }}
  section.card {{ background:white; border:1px solid #e1e4e8; border-radius:12px; padding:18px; margin-top:14px; }}
  figure {{ margin: 14px 0; }}
  figure img {{ width:100%; height:auto; border:1px solid #e1e4e8; border-radius:10px; }}
  figcaption {{ font-size: .95rem; color:#586069; margin-top:6px; }}
  ul {{ margin-top: 8px; }}
  code {{ background:#f1f3f5; padding:.1rem .3rem; border-radius:6px; }}
  .grid {{ display:grid; grid-template-columns: 1fr; gap:12px; }}
  @media(min-width:900px) {{ .grid{{ grid-template-columns: 1fr 1fr; }} }}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Artifact 5: Personal AI/ML Leadership Framework</h1>
      <p class="muted">Ethical, practical, and people-centered change</p>
    </header>

    <section class="card">
      <h2>Executive Summary (Non-Technical)</h2>
      <p>{EXEC_SUMMARY}</p>
    </section>

    <section class="card">
      <h2>Technical Overview (Technical Audience)</h2>
      <p>{TECH_OVERVIEW}</p>
    </section>

    <section class="card">
      <h2>Context & Problem</h2>
      <p>{CONTEXT}</p>
    </section>

    <section class="card">
      <h2>Approach</h2>
      <pre style="white-space: pre-wrap; background:#f6f8fa; border-radius:10px; padding:12px; border:1px solid #e1e4e8;">{APPROACH}</pre>
    </section>

    <section class="card">
      <h2>Audience Versions (Customization)</h2>
      <pre style="white-space: pre-wrap; background:#f6f8fa; border-radius:10px; padding:12px; border:1px solid #e1e4e8;">{AUDIENCES}</pre>
    </section>

    <section class="card">
      <h2>Competencies Demonstrated</h2>
      <pre style="white-space: pre-wrap; background:#f6f8fa; border-radius:10px; padding:12px; border:1px solid #e1e4e8;">{COMPETENCIES}</pre>
    </section>

    <section class="card">
      <h2>Outcome & Evidence</h2>
      <pre style="white-space: pre-wrap; background:#f6f8fa; border-radius:10px; padding:12px; border:1px solid #e1e4e8;">{OUTCOMES}</pre>
    </section>

    <section class="card">
      <h2>Metrics (Success Criteria)</h2>
      <pre style="white-space: pre-wrap; background:#f6f8fa; border-radius:10px; padding:12px; border:1px solid #e1e4e8;">{METRICS}</pre>
    </section>

    <section class="card">
      <h2>What I Changed Based on Workshop 5 Feedback</h2>
      <pre style="white-space: pre-wrap; background:#f6f8fa; border-radius:10px; padding:12px; border:1px solid #e1e4e8;">{CHANGES_FROM_FEEDBACK}</pre>
    </section>

    <section class="card grid">
      <div>
        <figure>
          <img src="{radar_path.name}" alt="Leadership competency radar chart">
          <figcaption><strong>Figure 1.</strong> Self-assessment across six leadership competencies.</figcaption>
        </figure>
        <figure>
          <img src="{gantt_path.name}" alt="Leadership roadmap Gantt">
          <figcaption><strong>Figure 2.</strong> Short-, mid-, and long-term actions across 12–18 months.</figcaption>
        </figure>
      </div>
      <div>
        <figure>
          <img src="{lifecycle_path.name}" alt="AI/ML governance lifecycle diagram">
          <figcaption><strong>Figure 3.</strong> Governance stages from problem framing to review &amp; iterate.</figcaption>
        </figure>
        <figure>
          <img src="{raci_path.name}" alt="RACI matrix for roles and activities">
          <figcaption><strong>Figure 4.</strong> RACI assignments across key activities.</figcaption>
        </figure>
      </div>
    </section>

    <section class="card">
      <h2>How This Artifact Completes the Portfolio</h2>
      <p>{COMPLETION}</p>
    </section>

    <section class="card">
      <h2>Download Reflection (Markdown)</h2>
      <p>File created alongside this page: <code>artifact5_reflection.md</code></p>
    </section>
  </div>
</body>
</html>
"""

# ---------- Write files ----------
write(OUT_DIR / "artifact5.html", HTML)
write(OUT_DIR / "artifact5_reflection.md", REFLECTION_MD)

print("✅ Artifact 5 built!")
print(f"Open: {OUT_DIR / 'artifact5.html'}")
print(f"Reflection: {OUT_DIR / 'artifact5_reflection.md'}")
print(f"Images saved in: {OUT_DIR}")
